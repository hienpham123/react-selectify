{"version":3,"file":"index.js","sources":["../../node_modules/style-inject/dist/style-inject.es.js","../../src/hooks/useSelection.ts","../../src/hooks/useFilter.ts","../../src/hooks/useKeyboard.ts","../../src/hooks/useClickOutside.ts","../../src/hooks/useDropdownPosition.ts","../../src/components/OptionItem/OptionItem.tsx","../../src/components/ReactSelectify/ReactSelectify.tsx"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { useState, useEffect, useCallback } from 'react';\r\nimport { Option } from '../types';\r\n\r\ninterface UseSelectionProps {\r\n    selectedKeys?: string[];\r\n    options: Option[];\r\n    multiple: boolean;\r\n    onChange?: (event?: React.FormEvent<HTMLElement | HTMLInputElement>, option?: Option) => void;\r\n}\r\n\r\nexport function useSelection({ selectedKeys, options, multiple, onChange }: UseSelectionProps) {\r\n    const [selected, setSelected] = useState<Option[]>([]);\r\n\r\n    // Sync selected state with selectedKeys prop\r\n    // Only sync if selectedKeys is provided (not undefined)\r\n    useEffect(() => {\r\n        // If selectedKeys is explicitly provided (even if empty array), sync with it\r\n        // If selectedKeys is undefined, keep internal state\r\n        if (selectedKeys !== undefined) {\r\n            setSelected((prev) => {\r\n                const kept = prev.filter((sel) => selectedKeys.includes(sel.key));\r\n\r\n                const added = selectedKeys\r\n                    .filter((val) => !prev.some((sel) => sel.key === val))\r\n                    .map((val) => {\r\n                        const opt = options.find((o) => o.key === val);\r\n                        return opt ?? { key: val, text: val };\r\n                    });\r\n\r\n                return Array.from(new Set([...kept, ...added]));\r\n            });\r\n        }\r\n    }, [selectedKeys, options]);\r\n\r\n    const handleSelection = useCallback((\r\n        event?: React.FormEvent<HTMLElement | HTMLInputElement>,\r\n        option?: Option,\r\n        checked?: boolean\r\n    ) => {\r\n        if (!option || option.disabled) return;\r\n\r\n        setSelected((prev) => {\r\n            if (!multiple) {\r\n                // Single-select mode: replace selected with current option\r\n                const updated = [option];\r\n                // Always call onChange, even if selectedKeys is not provided\r\n                onChange?.(event, { ...option, selected: true });\r\n                return updated;\r\n            } else {\r\n                // Multi-select mode: toggle the option\r\n                const exists = prev.find((x) => x.key === option.key);\r\n                const updated = exists\r\n                    ? prev.filter((x) => x.key !== option.key)\r\n                    : [...prev, option];\r\n                \r\n                // Calculate the new selected state\r\n                const isSelected = checked !== undefined ? checked : !exists;\r\n                // Always call onChange, even if selectedKeys is not provided\r\n                onChange?.(event, { ...option, selected: isSelected });\r\n                return updated;\r\n            }\r\n        });\r\n    }, [multiple, onChange]);\r\n\r\n    return { selected, handleSelection };\r\n}\r\n\r\n","import { useMemo } from 'react';\r\nimport { Option, OptionGroup } from '../types';\r\n\r\ninterface UseFilterProps {\r\n    options: Option[];\r\n    groups: OptionGroup[];\r\n    filter: string;\r\n}\r\n\r\nexport function useFilter({ options, groups, filter }: UseFilterProps) {\r\n    const flatOptions = !groups || groups.length === 0\r\n        ? options\r\n        : groups.flatMap(g => g.options);\r\n\r\n    const filteredOptions = useMemo(() => {\r\n        if (groups && groups.length > 0) return flatOptions;\r\n        return flatOptions.filter(opt =>\r\n            opt.text.toLowerCase().includes(filter.toLowerCase())\r\n        );\r\n    }, [groups, flatOptions, filter]);\r\n\r\n    const filteredGroups = useMemo(() => {\r\n        if (!groups || groups.length === 0) return undefined;\r\n        if (!filter) return groups;\r\n\r\n        return groups\r\n            .map(group => ({\r\n                ...group,\r\n                options: group.options.filter(opt =>\r\n                    opt.text.toLowerCase().includes(filter.toLowerCase())\r\n                ),\r\n            }))\r\n            .filter(group => group.options.length > 0);\r\n    }, [groups, filter]);\r\n\r\n    return { flatOptions, filteredOptions, filteredGroups };\r\n}\r\n\r\n","import { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { Option } from '../types';\r\n\r\ninterface UseKeyboardProps {\r\n    isOpen: boolean;\r\n    filteredOptions: Option[];\r\n    selected: Option[];\r\n    multiple: boolean;\r\n    onSelect: (event: React.KeyboardEvent<HTMLInputElement>, option: Option) => void;\r\n    optionRefs: React.MutableRefObject<{ [key: string]: HTMLLabelElement | null }>;\r\n}\r\n\r\nexport function useKeyboard({\r\n    isOpen,\r\n    filteredOptions,\r\n    selected,\r\n    multiple,\r\n    onSelect,\r\n    optionRefs\r\n}: UseKeyboardProps) {\r\n    const [highlightIndex, setHighlightIndex] = useState<number>(-1);\r\n\r\n    const handleKeyDown = useCallback(\r\n        (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n            if (!isOpen) return;\r\n\r\n            if (e.key === \"ArrowDown\" || e.key === \"ArrowUp\") {\r\n                e.preventDefault();\r\n\r\n                setHighlightIndex((prev) => {\r\n                    if (filteredOptions.length === 0) return -1;\r\n\r\n                    // If no item is highlighted, start from first/last item\r\n                    let nextIndex = prev;\r\n                    const direction = e.key === \"ArrowDown\" ? 1 : -1;\r\n                    \r\n                    if (prev < 0) {\r\n                        // Start from first item (index 0) for ArrowDown, or last item for ArrowUp\r\n                        nextIndex = direction === 1 ? 0 : filteredOptions.length - 1;\r\n                    } else {\r\n                        // Move to next/previous item\r\n                        nextIndex = (prev + direction + filteredOptions.length) % filteredOptions.length;\r\n                    }\r\n                    \r\n                    // Skip disabled items\r\n                    let attempts = 0;\r\n                    while (\r\n                        filteredOptions[nextIndex].disabled &&\r\n                        attempts < filteredOptions.length\r\n                    ) {\r\n                        nextIndex = (nextIndex + direction + filteredOptions.length) % filteredOptions.length;\r\n                        attempts++;\r\n                    }\r\n\r\n                    return nextIndex;\r\n                });\r\n            } else if (e.key === \"Enter\") {\r\n                e.preventDefault();\r\n\r\n                if (highlightIndex >= 0 && highlightIndex < filteredOptions.length) {\r\n                    const option = filteredOptions[highlightIndex];\r\n                    if (!option.disabled) {\r\n                        onSelect(e, option);\r\n                    }\r\n                }\r\n            } else if (e.key === \" \") {\r\n                // Only prevent space if an option is highlighted (to select it)\r\n                // Otherwise, allow space for typing/searching\r\n                if (highlightIndex >= 0 && highlightIndex < filteredOptions.length) {\r\n                    e.preventDefault();\r\n                    const option = filteredOptions[highlightIndex];\r\n                    if (!option.disabled) {\r\n                        onSelect(e, option);\r\n                    }\r\n                }\r\n                // If no option is highlighted, allow space to be typed normally\r\n            } else if (e.key === \"Escape\") {\r\n                e.preventDefault();\r\n                return false; // Signal to close dropdown\r\n            }\r\n            return true;\r\n        },\r\n        [filteredOptions, highlightIndex, isOpen, multiple, selected, onSelect]\r\n    );\r\n\r\n    // Scroll highlighted option into view\r\n    useEffect(() => {\r\n        if (!isOpen || highlightIndex < 0 || highlightIndex >= filteredOptions.length) return;\r\n\r\n        const option = filteredOptions[highlightIndex];\r\n        const el = optionRefs.current[option.key];\r\n        if (el) {\r\n            el.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\r\n        }\r\n    }, [highlightIndex, isOpen, filteredOptions, optionRefs]);\r\n\r\n    const resetHighlight = useCallback(() => {\r\n        setHighlightIndex(-1);\r\n    }, []);\r\n\r\n    const setHighlight = useCallback((index: number) => {\r\n        setHighlightIndex(index);\r\n    }, []);\r\n\r\n    return { highlightIndex, handleKeyDown, resetHighlight, setHighlight };\r\n}\r\n\r\n","import { useEffect, RefObject } from 'react';\r\n\r\ninterface UseClickOutsideProps {\r\n    ref: RefObject<HTMLDivElement | null>;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    inputRef: RefObject<HTMLInputElement | null>;\r\n}\r\n\r\nexport function useClickOutside({ ref, isOpen, onClose, inputRef }: UseClickOutsideProps) {\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const handleClickOutside = (e: MouseEvent) => {\r\n            if (!ref.current) return;\r\n            if (ref.current.contains(e.target as Node)) return;\r\n\r\n            const dialogElement = document.querySelector(\".ms-Dialog-main, .bc-dialog, .ms-Layer\");\r\n            if (dialogElement && dialogElement.contains(e.target as Node)) {\r\n                const comboTrigger = ref.current.querySelector(\"input\");\r\n                if (comboTrigger && comboTrigger.contains(e.target as Node)) return;\r\n            }\r\n\r\n            onClose();\r\n        };\r\n\r\n        document.addEventListener(\"mousedown\", handleClickOutside, true);\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside, true);\r\n    }, [isOpen, ref, onClose, inputRef]);\r\n}\r\n\r\n","import { useState, useEffect, useLayoutEffect, useRef, RefObject } from 'react';\r\n\r\ninterface UseDropdownPositionProps {\r\n    isOpen: boolean;\r\n    positionOffset?: 'top' | 'bottom';\r\n    dropdownRef: RefObject<HTMLDivElement | null>;\r\n    inputRef: RefObject<HTMLInputElement | null>;\r\n}\r\n\r\nexport function useDropdownPosition({\r\n    isOpen,\r\n    positionOffset,\r\n    dropdownRef,\r\n    inputRef\r\n}: UseDropdownPositionProps) {\r\n    const [actualPosition, setActualPosition] = useState<'top' | 'bottom'>(positionOffset || 'bottom');\r\n\r\n    // Calculate position synchronously before paint to avoid flickering\r\n    useLayoutEffect(() => {\r\n        if (!isOpen) {\r\n            return;\r\n        }\r\n\r\n        const calculatePosition = () => {\r\n            // Get the actual input element from FluentUI TextField ref\r\n            let inputElement: HTMLElement | null = null;\r\n            if (inputRef.current) {\r\n                // FluentUI TextField ref can be the component instance or the input element\r\n                // Check if it's a DOM element directly\r\n                if (inputRef.current instanceof HTMLElement) {\r\n                    inputElement = inputRef.current;\r\n                } else if ((inputRef.current as any).element) {\r\n                    inputElement = (inputRef.current as any).element;\r\n                } else if ((inputRef.current as any).querySelector) {\r\n                    inputElement = (inputRef.current as any).querySelector('input');\r\n                }\r\n            }\r\n\r\n            // Fallback: try to find input from parent element (before dropdown renders)\r\n            if (!inputElement && dropdownRef.current) {\r\n                const inputWrapper = dropdownRef.current.parentElement?.querySelector('.hh-Input-Wrapper');\r\n                inputElement = inputWrapper?.querySelector('input') as HTMLElement || null;\r\n            }\r\n\r\n            // Fallback: find input from document\r\n            if (!inputElement) {\r\n                const inputWrapper = document.querySelector('.hh-Input-Wrapper');\r\n                inputElement = inputWrapper?.querySelector('input') as HTMLElement || null;\r\n            }\r\n\r\n            if (!inputElement) {\r\n                // If can't find input, use default position\r\n                setActualPosition(positionOffset || 'bottom');\r\n                return;\r\n            }\r\n\r\n            const inputRect = inputElement.getBoundingClientRect();\r\n            \r\n            if (!inputRect) {\r\n                setActualPosition(positionOffset || 'bottom');\r\n                return;\r\n            }\r\n\r\n            // Get viewport dimensions\r\n            const viewportHeight = window.innerHeight;\r\n\r\n            // Calculate space below and above\r\n            const spaceBelow = viewportHeight - inputRect.bottom;\r\n            const spaceAbove = inputRect.top;\r\n\r\n            // Use estimated dropdown height (max-height is 300px from CSS)\r\n            const estimatedDropdownHeight = 300;\r\n\r\n            // If user explicitly set position, respect it unless there's not enough space\r\n            if (positionOffset === 'top') {\r\n                setActualPosition('top');\r\n            } else if (positionOffset === 'bottom') {\r\n                // Check if there's enough space below\r\n                if (spaceBelow >= estimatedDropdownHeight || spaceBelow >= spaceAbove) {\r\n                    setActualPosition('bottom');\r\n                } else {\r\n                    // Not enough space below, check if top has more space\r\n                    if (spaceAbove > spaceBelow) {\r\n                        setActualPosition('top');\r\n                    } else {\r\n                        setActualPosition('bottom');\r\n                    }\r\n                }\r\n            } else {\r\n                // Auto mode: choose position with more space\r\n                if (spaceAbove > spaceBelow && spaceAbove >= estimatedDropdownHeight) {\r\n                    setActualPosition('top');\r\n                } else {\r\n                    setActualPosition('bottom');\r\n                }\r\n            }\r\n        };\r\n\r\n        // Calculate position synchronously before render to avoid flickering\r\n        // Use flushSync or immediate calculation\r\n        calculatePosition();\r\n\r\n        // Recalculate on scroll and resize (only when open)\r\n        const handleScroll = () => {\r\n            if (isOpen) {\r\n                calculatePosition();\r\n            }\r\n        };\r\n        \r\n        const handleResize = () => {\r\n            if (isOpen) {\r\n                calculatePosition();\r\n            }\r\n        };\r\n\r\n        window.addEventListener('scroll', handleScroll, true);\r\n        window.addEventListener('resize', handleResize);\r\n\r\n        return () => {\r\n            window.removeEventListener('scroll', handleScroll, true);\r\n            window.removeEventListener('resize', handleResize);\r\n        };\r\n    }, [isOpen, positionOffset, dropdownRef, inputRef]);\r\n\r\n    return actualPosition;\r\n}\r\n\r\n","import React, { FormEvent, useCallback, useMemo } from 'react';\r\nimport { Checkbox } from '@fluentui/react';\r\nimport { Option } from '../../types';\r\n\r\ninterface OptionItemProps {\r\n    option: Option;\r\n    isSelected: boolean;\r\n    isHighlighted: boolean;\r\n    multiple: boolean;\r\n    showTooltip: boolean;\r\n    renderOption?: (props: any) => React.ReactNode;\r\n    onSelect: (event: React.FormEvent<HTMLElement | HTMLInputElement>, option: Option, checked?: boolean) => void;\r\n    optionRef: (el: HTMLLabelElement | null) => void;\r\n}\r\n\r\nconst OptionItem: React.FC<OptionItemProps> = ({\r\n    option,\r\n    isSelected,\r\n    isHighlighted,\r\n    multiple,\r\n    showTooltip,\r\n    renderOption,\r\n    onSelect,\r\n    optionRef\r\n}) => {\r\n    const handleClick = useCallback((event: React.FormEvent<HTMLElement | HTMLInputElement>) => {\r\n        if (option.disabled) return;\r\n        \r\n        const target = event.target as HTMLElement;\r\n        \r\n        // Don't handle click if clicking directly on checkbox input (it has its own handler)\r\n        if (target.tagName === 'INPUT' && target.getAttribute('type') === 'checkbox') {\r\n            return;\r\n        }\r\n        \r\n        // Don't handle if clicking on checkbox container elements\r\n        const checkboxContainer = target.closest('.ms-Checkbox') || \r\n                                  target.closest('[role=\"checkbox\"]') ||\r\n                                  target.closest('.checkbox-wrapper');\r\n        if (checkboxContainer) {\r\n            return;\r\n        }\r\n        \r\n        // If clicking on option-text or label itself, toggle selection\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        // For multiple mode, pass !isSelected to toggle\r\n        // For single mode, pass true to select\r\n        onSelect(event, option, multiple ? !isSelected : true);\r\n    }, [option, multiple, isSelected, onSelect]);\r\n\r\n    const handleCheckboxChange = useCallback((\r\n        ev?: React.FormEvent<HTMLElement | HTMLInputElement>,\r\n        checked?: boolean\r\n    ) => {\r\n        if (option.disabled) return;\r\n        if (ev) {\r\n            ev.stopPropagation();\r\n            ev.preventDefault();\r\n            onSelect(ev, option, checked);\r\n        } else {\r\n            // Create a synthetic event if none provided\r\n            const syntheticEvent = {\r\n                stopPropagation: () => {},\r\n                preventDefault: () => {},\r\n            } as React.FormEvent<HTMLElement | HTMLInputElement>;\r\n            onSelect(syntheticEvent, option, checked);\r\n        }\r\n    }, [option, onSelect]);\r\n\r\n    const handleWrapperClick = useCallback((e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n    }, []);\r\n\r\n    const commonProps = useMemo(() => ({\r\n        \"data-key\": option.key,\r\n        key: option.key,\r\n        className: `hh-Option-Item ${option.disabled ? \"disabled\" : \"\"} ${isHighlighted ? \"highlighted\" : \"\"}`,\r\n        tabIndex: 0,\r\n        ref: optionRef,\r\n        title: showTooltip ? option.text : undefined,\r\n        onClick: handleClick\r\n    }), [option.key, option.disabled, isHighlighted, showTooltip, option.text, optionRef, handleClick]);\r\n\r\n    if (renderOption) {\r\n        return (\r\n            <label {...commonProps}>\r\n                {renderOption({\r\n                    option,\r\n                    selected: isSelected,\r\n                    highlighted: isHighlighted,\r\n                    disabled: option.disabled,\r\n                    onSelect: (e: React.FormEvent<HTMLElement | HTMLInputElement> | FormEvent<HTMLElement | HTMLInputElement>) => {\r\n                        const event = e as React.FormEvent<HTMLElement | HTMLInputElement>;\r\n                        handleClick(event);\r\n                    },\r\n                })}\r\n            </label>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <label {...commonProps}>\r\n            {multiple && (\r\n                <span \r\n                    className=\"checkbox-wrapper\"\r\n                    onClick={handleWrapperClick}\r\n                >\r\n                    <Checkbox\r\n                        ariaLabelledBy={option.key}\r\n                        ariaDescribedBy={option.text}\r\n                        checked={isSelected}\r\n                        onChange={handleCheckboxChange}\r\n                        disabled={option.disabled}\r\n                    />\r\n                </span>\r\n            )}\r\n            <span className=\"option-text\">{option.text}</span>\r\n        </label>\r\n    );\r\n};\r\n\r\n// Memoize component to prevent unnecessary re-renders\r\n// Note: We don't compare onSelect and optionRef as they are functions and will always be different\r\nexport const MemoizedOptionItem = React.memo(OptionItem, (prevProps, nextProps) => {\r\n    // Only compare primitive values and option object properties\r\n    return (\r\n        prevProps.option.key === nextProps.option.key &&\r\n        prevProps.isSelected === nextProps.isSelected &&\r\n        prevProps.isHighlighted === nextProps.isHighlighted &&\r\n        prevProps.multiple === nextProps.multiple &&\r\n        prevProps.showTooltip === nextProps.showTooltip &&\r\n        prevProps.option.disabled === nextProps.option.disabled &&\r\n        prevProps.option.text === nextProps.option.text &&\r\n        prevProps.renderOption === nextProps.renderOption\r\n    );\r\n});\r\n\r\nexport { OptionItem };\r\n\r\n","import React, { useState, useRef, useEffect, useLayoutEffect, useCallback, useMemo } from \"react\";\r\nimport \"./ReactSelectify.css\";\r\nimport { Icon, TextField } from \"@fluentui/react\";\r\nimport { ReactSelectifyProps, Option, OptionGroup } from \"../../types\";\r\nimport { useSelection } from \"../../hooks/useSelection\";\r\nimport { useFilter } from \"../../hooks/useFilter\";\r\nimport { useKeyboard } from \"../../hooks/useKeyboard\";\r\nimport { useClickOutside } from \"../../hooks/useClickOutside\";\r\nimport { useDropdownPosition } from \"../../hooks/useDropdownPosition\";\r\nimport { OptionItem } from \"../OptionItem/OptionItem\";\r\n\r\nexport default function ReactSelectify(props: ReactSelectifyProps) {\r\n    const {\r\n        options = [],\r\n        groups = [],\r\n        selectedKeys,\r\n        onChange,\r\n        disabled = false,\r\n        placeholder,\r\n        positionOffset = 'bottom',\r\n        styles = {},\r\n        showTooltip = false,\r\n        className = '',\r\n        multiple = false,\r\n        renderOption\r\n    } = props;\r\n\r\n    const [isOpen, setIsOpen] = useState<boolean>(false);\r\n    const [filter, setFilter] = useState<string>(\"\");\r\n\r\n    // Refs\r\n    const dropdownRef = useRef<HTMLDivElement>(null);\r\n    const optionRefs = useRef<{ [key: string]: HTMLLabelElement | null }>({});\r\n    const hasOpened = useRef<boolean>(false);\r\n    const hasSetInitialHighlight = useRef<boolean>(false);\r\n    const inputRef = useRef<HTMLInputElement | any>(null);\r\n\r\n    // Hooks\r\n    const { selected, handleSelection } = useSelection({\r\n        selectedKeys,\r\n        options: !groups || groups.length === 0 ? options : groups.flatMap(g => g.options),\r\n        multiple,\r\n        onChange\r\n    });\r\n\r\n    const { flatOptions, filteredOptions, filteredGroups } = useFilter({\r\n        options,\r\n        groups,\r\n        filter\r\n    });\r\n\r\n    // Create Set for O(1) lookup instead of O(n) with some()\r\n    const selectedKeysSet = useMemo(() => {\r\n        return new Set(selected.map(s => s.key));\r\n    }, [selected]);\r\n\r\n    // Create Map for O(1) lookup instead of O(n) with findIndex()\r\n    const optionIndexMap = useMemo(() => {\r\n        const map = new Map<string, number>();\r\n        flatOptions.forEach((opt, index) => {\r\n            map.set(opt.key, index);\r\n        });\r\n        return map;\r\n    }, [flatOptions]);\r\n\r\n\r\n    // Calculate position synchronously in render phase to avoid flickering\r\n    // This calculates based on input element (available before dropdown renders)\r\n    const calculatedPosition = useMemo(() => {\r\n        if (!isOpen) {\r\n            return positionOffset || 'bottom';\r\n        }\r\n\r\n        // Get the actual input element\r\n        let inputElement: HTMLElement | null = null;\r\n        if (inputRef.current) {\r\n            if (inputRef.current instanceof HTMLElement) {\r\n                inputElement = inputRef.current;\r\n            } else if ((inputRef.current as any).element) {\r\n                inputElement = (inputRef.current as any).element;\r\n            } else if ((inputRef.current as any).querySelector) {\r\n                inputElement = (inputRef.current as any).querySelector('input');\r\n            }\r\n        }\r\n\r\n        // Fallback: try to find input from document\r\n        if (!inputElement) {\r\n            const inputWrapper = document.querySelector('.hh-Input-Wrapper');\r\n            inputElement = inputWrapper?.querySelector('input') as HTMLElement || null;\r\n        }\r\n\r\n        if (!inputElement) {\r\n            return positionOffset || 'bottom';\r\n        }\r\n\r\n        const inputRect = inputElement.getBoundingClientRect();\r\n        if (!inputRect) {\r\n            return positionOffset || 'bottom';\r\n        }\r\n\r\n        const viewportHeight = window.innerHeight;\r\n        const spaceBelow = viewportHeight - inputRect.bottom;\r\n        const spaceAbove = inputRect.top;\r\n        const estimatedDropdownHeight = 300;\r\n\r\n        if (positionOffset === 'top') {\r\n            return 'top';\r\n        } else if (positionOffset === 'bottom') {\r\n            if (spaceBelow >= estimatedDropdownHeight || spaceBelow >= spaceAbove) {\r\n                return 'bottom';\r\n            } else {\r\n                return spaceAbove > spaceBelow ? 'top' : 'bottom';\r\n            }\r\n        } else {\r\n            return spaceAbove > spaceBelow && spaceAbove >= estimatedDropdownHeight ? 'top' : 'bottom';\r\n        }\r\n    }, [isOpen, positionOffset, inputRef]);\r\n\r\n    // Create handleSelect that will be used by both keyboard and click handlers\r\n    const handleSelectRef = useRef<(event: React.KeyboardEvent<HTMLInputElement> | React.FormEvent<HTMLElement | HTMLInputElement>, option: Option, checked?: boolean) => void>(() => {});\r\n    \r\n    const { highlightIndex, handleKeyDown, resetHighlight, setHighlight } = useKeyboard({\r\n        isOpen,\r\n        filteredOptions,\r\n        selected,\r\n        multiple,\r\n        onSelect: (event, option) => {\r\n            // Call the actual handleSelect if it exists (for keyboard navigation)\r\n            handleSelectRef.current?.(event, option, undefined);\r\n        },\r\n        optionRefs\r\n    });\r\n\r\n    // Now create handleSelect with access to resetHighlight\r\n    const handleSelect = useCallback((event: React.KeyboardEvent<HTMLInputElement> | React.FormEvent<HTMLElement | HTMLInputElement>, option: Option, checked?: boolean) => {\r\n        // Check if this is a keyboard event (Enter/Space) or click event\r\n        // KeyboardEvent has key property, FormEvent from click doesn't\r\n        const isKeyboardEvent = 'key' in event;\r\n        \r\n        if (multiple) {\r\n            // For multiple mode, pass the checked value directly to handleSelection\r\n            // handleSelection will handle the toggle logic internally\r\n            handleSelection(event, option, checked);\r\n            \r\n            // Only reset highlight and refocus on click, not on keyboard navigation\r\n            // This allows user to continue using arrow keys after Enter\r\n            if (!isKeyboardEvent) {\r\n                resetHighlight();\r\n                // Use setTimeout to ensure focus happens after state updates\r\n                setTimeout(() => {\r\n                    inputRef.current?.focus();\r\n                }, 0);\r\n            }\r\n        } else {\r\n            // For single select, always select and close\r\n            handleSelection(event, option, true);\r\n            setIsOpen(false);\r\n            setFilter(\"\"); // Clear filter when closing\r\n        }\r\n    }, [multiple, handleSelection, resetHighlight]);\r\n\r\n    // Update ref so keyboard handler can use it\r\n    handleSelectRef.current = handleSelect;\r\n\r\n    // Use calculated position directly, only recalculate on scroll/resize\r\n    const actualPosition = useDropdownPosition({\r\n        isOpen,\r\n        positionOffset: calculatedPosition,\r\n        dropdownRef,\r\n        inputRef\r\n    });\r\n\r\n    const handleClose = useCallback(() => {\r\n        setIsOpen(false);\r\n        setFilter(\"\");\r\n        resetHighlight();\r\n        inputRef.current?.blur();\r\n    }, [resetHighlight]);\r\n\r\n    useClickOutside({\r\n        ref: dropdownRef,\r\n        isOpen,\r\n        onClose: handleClose,\r\n        inputRef\r\n    });\r\n\r\n    // When dropdown opens, highlight selected item in single select mode\r\n    // But only set it once when opening, don't reset on every change\r\n    useEffect(() => {\r\n        if (!isOpen) {\r\n            resetHighlight();\r\n            hasSetInitialHighlight.current = false;\r\n        } else if (isOpen && !multiple && !hasSetInitialHighlight.current) {\r\n            // Only set highlight once when dropdown first opens\r\n            if (selected.length > 0 && filteredOptions.length > 0) {\r\n                // Find the first selected option in filteredOptions\r\n                const firstSelectedIndex = filteredOptions.findIndex(opt => \r\n                    selected.some(sel => sel.key === opt.key)\r\n                );\r\n                if (firstSelectedIndex >= 0) {\r\n                    // Use setTimeout to ensure this runs after the dropdown is rendered\r\n                    setTimeout(() => {\r\n                        setHighlight(firstSelectedIndex);\r\n                        hasSetInitialHighlight.current = true;\r\n                    }, 0);\r\n                } else {\r\n                    hasSetInitialHighlight.current = true;\r\n                }\r\n            } else {\r\n                hasSetInitialHighlight.current = true;\r\n            }\r\n        }\r\n    }, [isOpen, multiple, selected, filteredOptions, setHighlight, resetHighlight]);\r\n\r\n    // When dropdown opens, scroll first selected option into view\r\n    useEffect(() => {\r\n        if (isOpen && !hasOpened.current && selected.length > 0) {\r\n            const sortedSelected = [...selected].sort((a, b) =>\r\n                a.text.localeCompare(b.text)\r\n            );\r\n\r\n            const firstCheckedKey = sortedSelected[0].key;\r\n            const el = optionRefs.current[firstCheckedKey];\r\n            if (el) {\r\n                el.scrollIntoView({ block: \"nearest\" });\r\n            }\r\n\r\n            hasOpened.current = true;\r\n        }\r\n\r\n        if (!isOpen) {\r\n            hasOpened.current = false;\r\n        }\r\n    }, [isOpen, selected]);\r\n\r\n    const toggleDropdown = () => {\r\n        if (!disabled) {\r\n            setIsOpen(true);\r\n        }\r\n    };\r\n\r\n    const handleInputChange = (e: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        setFilter(e.currentTarget.value);\r\n        setIsOpen(true);\r\n    };\r\n\r\n    const handleInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        const shouldClose = handleKeyDown(e);\r\n        if (shouldClose === false) {\r\n            setIsOpen(false);\r\n        }\r\n    };\r\n\r\n    const getDisplayValue = () => {\r\n        if (selected.length === 0) return \"\";\r\n        if (!multiple) return selected[0].text;\r\n        return selected.map(x => x.text).join(\", \");\r\n    };\r\n\r\n    const getInputValue = () => {\r\n        if (isOpen) {\r\n            return filter;\r\n        }\r\n        return \"\";\r\n    };\r\n\r\n    return (\r\n        <div className={`hh-Multi-Select ${className}`} ref={dropdownRef} style={{ ...styles['root'] }}>\r\n            <div className={`hh-Input-Wrapper ${disabled ? 'disabled' : ''}`}>\r\n                <TextField\r\n                    componentRef={inputRef}\r\n                    placeholder={getDisplayValue() || placeholder}\r\n                    onClick={toggleDropdown}\r\n                    onKeyDown={handleInputKeyDown}\r\n                    onChange={handleInputChange}\r\n                    value={getInputValue()}\r\n                    className=\"hh-Input-Display\"\r\n                    disabled={disabled}\r\n                    style={{ ...styles['input'] }}\r\n                    autoComplete=\"off\"\r\n                    readOnly={!isOpen && multiple}\r\n                />\r\n                <div className=\"hh-ChevronDown-Icon\">\r\n                    <Icon iconName=\"ChevronDown\" style={{ fontSize: 16 }} />\r\n                </div>\r\n            </div>\r\n\r\n            {isOpen && (\r\n                <div className={`hh-Dropdown ${actualPosition}`}>\r\n                    <div className=\"hh-Options-List\" style={{ ...styles['callOut'] }}>\r\n                        {filteredGroups !== undefined ? (\r\n                            filteredGroups.length === 0 ? (\r\n                                <div className=\"hh-No-Result\">\r\n                                    No results found\r\n                                </div>\r\n                            ) : filteredGroups.map((group) => (\r\n                            <div key={group.label} className=\"hh-Option-Group\">\r\n                                <div style={{ ...styles['groupLabel'] }} className=\"hh-Option-GroupLabel\">\r\n                                    {group.label}\r\n                                </div>\r\n                                {group.options.map((option) => {\r\n                                    const globalIndex = optionIndexMap.get(option.key) ?? -1;\r\n                                    const isSelected = selectedKeysSet.has(option.key);\r\n                                    const isHighlighted = highlightIndex === globalIndex;\r\n\r\n                                    return (\r\n                                        <OptionItem\r\n                                            key={option.key}\r\n                                            option={option}\r\n                                            isSelected={isSelected}\r\n                                            isHighlighted={isHighlighted}\r\n                                            multiple={multiple}\r\n                                            showTooltip={showTooltip}\r\n                                            renderOption={renderOption}\r\n                                            onSelect={handleSelect}\r\n                                            optionRef={(el: HTMLLabelElement | null) => {\r\n                                                optionRefs.current[option.key] = el;\r\n                                            }}\r\n                                        />\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        ))\r\n                        ) : filteredOptions.length === 0 ? (\r\n                            <div className=\"hh-No-Result\">\r\n                                No results found\r\n                            </div>\r\n                        ) : filteredOptions.map((option, i) => {\r\n                            const isSelected = selectedKeysSet.has(option.key);\r\n                            const isHighlighted = highlightIndex === i;\r\n\r\n                            return (\r\n                                <OptionItem\r\n                                    key={option.key}\r\n                                    option={option}\r\n                                    isSelected={isSelected}\r\n                                    isHighlighted={isHighlighted}\r\n                                    multiple={multiple}\r\n                                    showTooltip={showTooltip}\r\n                                    renderOption={renderOption}\r\n                                    onSelect={handleSelect}\r\n                                    optionRef={(el: HTMLLabelElement | null) => {\r\n                                        optionRefs.current[option.key] = el;\r\n                                    }}\r\n                                />\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n"],"names":["useState","useEffect","useCallback","useMemo","useLayoutEffect","React","Checkbox","useRef","TextField","Icon"],"mappings":"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"}